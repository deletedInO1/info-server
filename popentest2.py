import subprocess


cmd = "py popentest_cmd.py"
#cmd = r"F:\storage\Programming\infoProjektServer\winllama -ins -t 3 -ngl 1 -m C:\Users\Admin\Desktop\llm_models\llama-2-7b-chat.ggmlv3.q2_K.bin -c 2048 --temp 0.7 --repeat_penalty 1.1 -s 42 -n -1"

process = subprocess.Popen(cmd, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)

def read():
    while True:
        output = process.stdout.readline()
        print(output)
        if not output:
            break

def send_input(x):
    process.stdin.write((x + "\n").encode())
    process.stdin.flush()

send_input("1")
read()
send_input("2")
read()
send_input("3")
read()
send_input("stop")
read()
process.wait()
process.stdin.close()
process.stdout.close()
process.stderr.close()

print("lol")